<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: transaction.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: transaction.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { PagSeguro } from './pagseguro'
import { sandbox, production } from './config'

global.fetch = require('node-fetch')

/**
 * class Transaction represent the transaction pagseguro api endpoint
 *
 * @extends {PagSeguro}
 */
class Transaction extends PagSeguro {

  /**
   *
   * @param {string} email is email of account pagseguro, exemple vendor@email
   * @param {string} token is token of account pagseguro,
   * get the token in pagseguro configuration
   * @param {string} [url=sandbox] is a type of url api,
   * exemple 'sandbox' or 'production'
   */
  constructor(email, token, url = 'sandbox') {
    super(email, token, url)
    this.transaction.mode = 'default'
    this.transaction.receiverEmail = email
  }

  /**
   * setUrl
   * set url for requisition in pagseguro api
   *
   * @param {string} [v=v2] - version api url for requisition, example 'v3',
   * default value is 'v2'
   */
  setUrlVersion(v = 'v2') {
    this.url = `${this.mode == 'sandbox' ? sandbox : production}${v}/`
  }

  /**
   * setModeUrl
   *
   * @param {string} [mode=sandbox] - is trasaction mode,
   * 'sandbox' for test or 'production' for production
   */
  setModeUrl(mode = 'sandbox') {
    this.mode = mode
    this.setUrlVersion(this.url.substr(this.url.length - 3, 2))
  }

  /**
   * getSession
   *
   * @returns {Promise} promise - return a pagseguro session for transaction
   */
  getSession() {
    let promise = global.fetch(
      `${this.url}sessions?email=${this.email}&amp;token=${this.token}`,
      { method: 'POST' }
    )
    .then(data => data.text())

    return promise
  }

  /**
   * addItem
   *
   * @param {item} item - item buy
   */
  addItem(item) {
    if(!this.transaction.items)
      this.transaction.items = []

    this.transaction.items = [...this.transaction.items, { item }]
  }

  /**
   * @typedef item
   * @type {Object}
   * @property {string} id - id item
   * @property {string} description - description of item
   * @property {string} amount - unity cost
   * @property {number} quantity - unity quantity
   */

  /**
   * setItems
   *
   * @param {item[]} items - array of object item
   */
  setItems(items) {
    this.transaction.items = [...items]
  }

  /**
   * setSender
   *
   * @param {Object} sender - representing a buyer
   */
  setSender(sender) {
    this.transaction.sender = sender
  }

  /**
   * setShipping
   *
   * @param {Object} shipping - is a shipping of transaction
   */
  setShipping(shipping) {
    this.transaction.shipping = shipping
  }

  /**
   * setReference
   *
   * @param {string} reference - is a reference of transaction
   */
  setReference(reference) {
    this.transaction.reference = reference
  }

  /**
   * setCurrency
   *
   * @param {string} currency - is a symbol monetary, example Brazil id 'BRL'
   */
  setCurrency(currency) {
    this.transaction.currency = currency
  }

  /**
   * setNotificationUrl
   *
   * @param {string} url is your url for received notification of trasaction
   */
  setNotificationUrl(url) {
    this.transaction.notificationURL = url
  }
}

export { Transaction }
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-normalizeArrayAndObject.html">normalizeArrayAndObject</a></li><li><a href="module-utils.html">utils</a></li></ul><h3>Classes</h3><ul><li><a href="PagSeguro.html">PagSeguro</a></li><li><a href="Transaction.html">Transaction</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu Apr 05 2018 19:19:43 GMT-0300 (-03)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
